<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Nutrition Assistant | Bounty Millers Limited</title>
  <meta name="description" content="Get personalized feeding recommendations and nutritional guidance powered by AI. Expert advice for optimal animal nutrition and performance."><!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script><!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><!-- SDKs -->
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        /* AI Assistant Color Scheme */
        :root {
            --ai-primary: #6366f1;
            --ai-secondary: #10b981;
            --ai-accent: #f59e0b;
            --ai-surface: #f8fafc;
            --ai-text: #1f2937;
        }
        
        .bg-ai-primary { background-color: var(--ai-primary); }
        .bg-ai-secondary { background-color: var(--ai-secondary); }
        .bg-ai-accent { background-color: var(--ai-accent); }
        .bg-ai-surface { background-color: var(--ai-surface); }
        .text-ai-primary { color: var(--ai-primary); }
        .text-ai-secondary { color: var(--ai-secondary); }
        .text-ai-accent { color: var(--ai-accent); }
        .text-ai-text { color: var(--ai-text); }
        
        .gradient-ai {
            background: linear-gradient(135deg, var(--ai-primary) 0%, var(--ai-secondary) 100%);
        }
        
        .ai-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.1);
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .ai-card:hover {
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.15);
            border-color: var(--ai-secondary);
        }
        
        .chat-container {
            height: 500px;
            overflow-y: auto;
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e5e7eb;
        }
        
        .message {
            margin-bottom: 16px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .message.user {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            flex-shrink: 0;
        }
        
        .message.user .message-avatar {
            background: var(--ai-primary);
        }
        
        .message.assistant .message-avatar {
            background: var(--ai-secondary);
        }
        
        .message-content {
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            max-width: 80%;
            border: 1px solid #e5e7eb;
        }
        
        .message.user .message-content {
            background: var(--ai-primary);
            color: white;
        }
        
        .message.assistant .message-content {
            background: white;
            color: var(--ai-text);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 12px 16px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--ai-secondary);
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--ai-text);
            margin-bottom: 8px;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: white;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--ai-primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .btn-ai {
            background: linear-gradient(135deg, var(--ai-primary) 0%, var(--ai-secondary) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-ai:hover {
            background: linear-gradient(135deg, #5b5ff5 0%, #059669 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }
        
        .btn-ai:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .recommendation-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #ecfdf5 100%);
            border: 2px solid var(--ai-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-top: 16px;
        }
        
        .nutrition-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .nutrition-table th,
        .nutrition-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .nutrition-table th {
            background: var(--ai-surface);
            font-weight: 600;
            color: var(--ai-text);
        }
        
        .nutrition-table tr:hover {
            background: #f9fafb;
        }
        
        .quick-action {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quick-action:hover {
            border-color: var(--ai-primary);
            background: #f0f9ff;
            transform: translateY(-2px);
        }
        
        .quick-action i {
            font-size: 24px;
            color: var(--ai-primary);
            margin-bottom: 8px;
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--ai-secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 16px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success { background: var(--ai-secondary); }
        .toast.error { background: #ef4444; }
        .toast.warning { background: var(--ai-accent); }
        
        .history-item {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }
        
        .history-item:hover {
            border-color: var(--ai-primary);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-cattle { background: #fef3c7; color: #92400e; }
        .badge-poultry { background: #dbeafe; color: #1e40af; }
        .badge-swine { background: #fce7f3; color: #be185d; }
        .badge-sheep { background: #d1fae5; color: #065f46; }
        .badge-goat { background: #e0e7ff; color: #3730a3; }
        
        @media (max-width: 768px) {
            .chat-container {
                height: 400px;
            }
            
            .message-content {
                max-width: 90%;
            }
            
            .nutrition-table {
                font-size: 14px;
            }
            
            .nutrition-table th,
            .nutrition-table td {
                padding: 8px 12px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-ai-surface"><!-- Header -->
  <header class="gradient-ai text-white py-8">
   <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center">
     <h1 class="text-4xl md:text-5xl font-bold mb-4" id="assistant-title">AI Nutrition Assistant</h1>
     <p class="text-xl opacity-90 max-w-3xl mx-auto" id="assistant-subtitle">Get personalized feeding recommendations</p>
     <div class="flex justify-center items-center mt-6 space-x-6">
      <div class="flex items-center"><i class="fas fa-robot text-2xl mr-2"></i> <span class="font-semibold">AI-Powered</span>
      </div>
      <div class="flex items-center"><i class="fas fa-chart-line text-2xl mr-2"></i> <span class="font-semibold">Data-Driven</span>
      </div>
      <div class="flex items-center"><i class="fas fa-clock text-2xl mr-2"></i> <span class="font-semibold">24/7 Available</span>
      </div>
     </div>
    </div>
   </div>
  </header><!-- Main Content -->
  <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12"><!-- Welcome Section -->
   <div class="ai-card p-8 mb-8">
    <div class="text-center mb-8"><i class="fas fa-brain text-6xl text-ai-primary mb-4"></i>
     <h2 class="text-3xl font-bold text-ai-text mb-4" id="welcome-message">Welcome to our intelligent nutrition advisory system</h2>
     <p class="text-lg text-gray-600 max-w-3xl mx-auto">Get expert nutritional advice tailored to your animals' specific needs. Our AI assistant analyzes your requirements and provides personalized feeding recommendations, nutritional requirements, and feeding schedules.</p>
    </div><!-- Quick Actions -->
    <div class="grid md:grid-cols-4 gap-6 mb-8">
     <div class="quick-action" onclick="showConsultationForm()"><i class="fas fa-comments"></i>
      <h4 class="font-bold">New Consultation</h4>
      <p class="text-sm text-gray-600">Start a new nutrition consultation</p>
     </div>
     <div class="quick-action" onclick="showNutritionCalculator()"><i class="fas fa-calculator"></i>
      <h4 class="font-bold">Nutrition Calculator</h4>
      <p class="text-sm text-gray-600">Calculate nutritional requirements</p>
     </div>
     <div class="quick-action" onclick="showFeedingGuide()"><i class="fas fa-book-open"></i>
      <h4 class="font-bold">Feeding Guide</h4>
      <p class="text-sm text-gray-600">Browse feeding guidelines</p>
     </div>
     <div class="quick-action" onclick="showChatInterface()"><i class="fas fa-robot"></i>
      <h4 class="font-bold">AI Chat</h4>
      <p class="text-sm text-gray-600">Chat with nutrition AI</p>
     </div>
    </div>
   </div><!-- Consultation Form -->
   <div id="consultation-form" class="ai-card p-8 mb-8 hidden">
    <h3 class="text-2xl font-bold text-ai-primary mb-6"><i class="fas fa-clipboard-list mr-2"></i> Nutrition Consultation Form</h3>
    <form id="nutrition-form" onsubmit="submitConsultation(event)">
     <div class="grid md:grid-cols-2 gap-6">
      <div class="form-group"><label class="form-label" for="animal-type">Animal Type *</label> <select id="animal-type" class="form-select" required> <option value="">Select animal type</option> <option value="cattle">Dairy Cattle</option> <option value="beef-cattle">Beef Cattle</option> <option value="poultry">Poultry (Layers)</option> <option value="broilers">Poultry (Broilers)</option> <option value="swine">Swine</option> <option value="sheep">Sheep</option> <option value="goat">Goat</option> </select>
      </div>
      <div class="form-group"><label class="form-label" for="animal-weight">Average Weight (kg) *</label> <input type="number" id="animal-weight" class="form-input" min="1" max="1000" required>
      </div>
      <div class="form-group"><label class="form-label" for="production-stage">Production Stage *</label> <select id="production-stage" class="form-select" required> <option value="">Select production stage</option> <option value="growing">Growing</option> <option value="lactating">Lactating</option> <option value="dry">Dry Period</option> <option value="breeding">Breeding</option> <option value="finishing">Finishing</option> <option value="maintenance">Maintenance</option> </select>
      </div>
      <div class="form-group"><label class="form-label" for="current-feed">Current Feed Program</label> <input type="text" id="current-feed" class="form-input" placeholder="e.g., Commercial pellets, pasture + concentrate">
      </div>
     </div>
     <div class="form-group"><label class="form-label" for="health-issues">Health Issues or Special Requirements</label> <textarea id="health-issues" class="form-textarea" rows="3" placeholder="Describe any health issues, allergies, or special dietary requirements..."></textarea>
     </div>
     <div class="form-group"><label class="form-label" for="user-name">Your Name</label> <input type="text" id="user-name" class="form-input" placeholder="Enter your name">
     </div>
     <div class="flex gap-4"><button type="submit" class="btn-ai"> <i class="fas fa-magic"></i> Get AI Recommendation </button> <button type="button" onclick="hideConsultationForm()" class="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors"> <i class="fas fa-times mr-2"></i>Cancel </button>
     </div>
    </form>
   </div><!-- AI Chat Interface -->
   <div id="chat-interface" class="ai-card p-8 mb-8 hidden">
    <h3 class="text-2xl font-bold text-ai-primary mb-6"><i class="fas fa-robot mr-2"></i> AI Nutrition Chat</h3>
    <div id="chat-container" class="chat-container mb-4">
     <div class="message assistant">
      <div class="message-avatar"><i class="fas fa-robot"></i>
      </div>
      <div class="message-content">
       <p>Hello! I'm your AI nutrition assistant. I can help you with:</p>
       <ul class="mt-2 space-y-1">
        <li>• Feeding recommendations</li>
        <li>• Nutritional calculations</li>
        <li>• Feed formulation advice</li>
        <li>• Health and nutrition questions</li>
       </ul>
       <p class="mt-2">What would you like to know about animal nutrition?</p>
      </div>
     </div>
    </div>
    <div class="flex gap-4"><input type="text" id="chat-input" class="form-input flex-1" placeholder="Ask me about nutrition, feeding, or animal health..." onkeypress="handleChatKeyPress(event)"> <button onclick="sendChatMessage()" class="btn-ai"> <i class="fas fa-paper-plane"></i> Send </button>
    </div>
    <div class="flex justify-between items-center mt-4"><button onclick="clearChat()" class="text-gray-500 hover:text-gray-700 transition-colors"> <i class="fas fa-trash mr-1"></i>Clear Chat </button> <button onclick="hideChatInterface()" class="bg-gray-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-gray-600 transition-colors"> <i class="fas fa-times mr-1"></i>Close </button>
    </div>
   </div><!-- Nutrition Calculator -->
   <div id="nutrition-calculator" class="ai-card p-8 mb-8 hidden">
    <h3 class="text-2xl font-bold text-ai-primary mb-6"><i class="fas fa-calculator mr-2"></i> Nutrition Requirements Calculator</h3>
    <div class="grid md:grid-cols-3 gap-6 mb-6">
     <div class="form-group"><label class="form-label" for="calc-animal">Animal Type</label> <select id="calc-animal" class="form-select" onchange="updateCalculator()"> <option value="dairy-cow">Dairy Cow</option> <option value="beef-cattle">Beef Cattle</option> <option value="broiler">Broiler Chicken</option> <option value="layer">Layer Hen</option> <option value="pig">Pig</option> </select>
     </div>
     <div class="form-group"><label class="form-label" for="calc-weight">Body Weight (kg)</label> <input type="number" id="calc-weight" class="form-input" value="500" min="1" onchange="updateCalculator()">
     </div>
     <div class="form-group"><label class="form-label" for="calc-production">Production Level</label> <input type="number" id="calc-production" class="form-input" placeholder="e.g., 25 L/day for dairy" onchange="updateCalculator()">
     </div>
    </div>
    <div id="nutrition-results">
     <h4 class="text-xl font-bold text-ai-text mb-4">Daily Nutritional Requirements</h4>
     <table class="nutrition-table">
      <thead>
       <tr>
        <th>Nutrient</th>
        <th>Requirement</th>
        <th>Unit</th>
        <th>Notes</th>
       </tr>
      </thead>
      <tbody id="nutrition-table-body"><!-- Will be populated by JavaScript -->
      </tbody>
     </table>
    </div>
    <div class="mt-6"><button onclick="hideNutritionCalculator()" class="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors"> <i class="fas fa-times mr-2"></i>Close Calculator </button>
    </div>
   </div><!-- Feeding Guide -->
   <div id="feeding-guide" class="ai-card p-8 mb-8 hidden">
    <h3 class="text-2xl font-bold text-ai-primary mb-6"><i class="fas fa-book-open mr-2"></i> Feeding Guidelines &amp; Best Practices</h3>
    <div class="grid md:grid-cols-2 gap-8">
     <div>
      <h4 class="text-xl font-bold text-ai-text mb-4">Dairy Cattle</h4>
      <div class="space-y-4">
       <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
        <h5 class="font-bold">Lactating Cows</h5>
        <p class="text-sm">3-4% of body weight in dry matter. High-quality forage with 16-18% crude protein.</p>
       </div>
       <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
        <h5 class="font-bold">Dry Cows</h5>
        <p class="text-sm">2% of body weight in dry matter. 12-14% crude protein, controlled energy.</p>
       </div>
      </div>
     </div>
     <div>
      <h4 class="text-xl font-bold text-ai-text mb-4">Poultry</h4>
      <div class="space-y-4">
       <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500">
        <h5 class="font-bold">Broilers</h5>
        <p class="text-sm">Starter: 23% protein, Grower: 20% protein, Finisher: 18% protein.</p>
       </div>
       <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500">
        <h5 class="font-bold">Layers</h5>
        <p class="text-sm">16-18% protein, 3.5-4% calcium during laying period.</p>
       </div>
      </div>
     </div>
    </div>
    <div class="mt-8">
     <h4 class="text-xl font-bold text-ai-text mb-4">General Feeding Principles</h4>
     <div class="grid md:grid-cols-3 gap-6">
      <div class="text-center p-6 bg-gray-50 rounded-lg"><i class="fas fa-clock text-3xl text-ai-primary mb-3"></i>
       <h5 class="font-bold mb-2">Regular Schedule</h5>
       <p class="text-sm">Feed at consistent times daily</p>
      </div>
      <div class="text-center p-6 bg-gray-50 rounded-lg"><i class="fas fa-tint text-3xl text-ai-secondary mb-3"></i>
       <h5 class="font-bold mb-2">Fresh Water</h5>
       <p class="text-sm">Provide clean water at all times</p>
      </div>
      <div class="text-center p-6 bg-gray-50 rounded-lg"><i class="fas fa-balance-scale text-3xl text-ai-accent mb-3"></i>
       <h5 class="font-bold mb-2">Balanced Nutrition</h5>
       <p class="text-sm">Meet all nutritional requirements</p>
      </div>
     </div>
    </div>
    <div class="mt-6"><button onclick="hideFeedingGuide()" class="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors"> <i class="fas fa-times mr-2"></i>Close Guide </button>
    </div>
   </div><!-- Consultation History -->
   <div class="ai-card p-8">
    <h3 class="text-2xl font-bold text-ai-primary mb-6"><i class="fas fa-history mr-2"></i> Consultation History</h3>
    <div id="consultation-history">
     <div class="text-center py-8 text-gray-500"><i class="fas fa-clipboard-list text-4xl mb-4 opacity-50"></i>
      <p>No consultations yet. Start your first nutrition consultation to see recommendations here!</p>
     </div>
    </div>
   </div>
  </main><!-- Company Info -->
  <section class="gradient-ai text-white py-12 mt-16">
   <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <h2 class="text-3xl font-bold mb-4" id="company-name">Bounty Millers Limited</h2>
    <p class="text-xl opacity-90 mb-8">Advancing animal nutrition through AI-powered solutions</p>
    <div class="flex flex-col sm:flex-row gap-4 justify-center"><a href="tel:+254727455027" class="bg-white text-ai-primary px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors"> <i class="fas fa-phone mr-2"></i>+254727455027 </a> <a href="mailto:info@bountymillers.com" class="bg-ai-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-orange-600 transition-colors"> <i class="fas fa-envelope mr-2"></i>info@bountymillers.com </a>
    </div>
   </div>
  </section>
  <script>
        // Global variables
        let consultationHistory = [];
        let currentRecordCount = 0;
        let chatMessages = [];

        // Nutrition data
        const nutritionData = {
            'dairy-cow': {
                name: 'Dairy Cow',
                requirements: [
                    { nutrient: 'Dry Matter', requirement: '3-4% BW', unit: 'kg/day', notes: 'Based on body weight' },
                    { nutrient: 'Crude Protein', requirement: '16-18', unit: '%', notes: 'Of total dry matter' },
                    { nutrient: 'Energy (NEL)', requirement: '1.6-1.8', unit: 'Mcal/kg', notes: 'Net energy for lactation' },
                    { nutrient: 'Calcium', requirement: '0.7-0.9', unit: '%', notes: 'Higher during lactation' },
                    { nutrient: 'Phosphorus', requirement: '0.4-0.5', unit: '%', notes: 'Ca:P ratio 2:1' },
                    { nutrient: 'Fiber (NDF)', requirement: '28-35', unit: '%', notes: 'Neutral detergent fiber' }
                ]
            },
            'beef-cattle': {
                name: 'Beef Cattle',
                requirements: [
                    { nutrient: 'Dry Matter', requirement: '2-3% BW', unit: 'kg/day', notes: 'Based on body weight' },
                    { nutrient: 'Crude Protein', requirement: '12-16', unit: '%', notes: 'Varies by growth stage' },
                    { nutrient: 'Energy (TDN)', requirement: '65-75', unit: '%', notes: 'Total digestible nutrients' },
                    { nutrient: 'Calcium', requirement: '0.3-0.6', unit: '%', notes: 'Higher for growing cattle' },
                    { nutrient: 'Phosphorus', requirement: '0.2-0.4', unit: '%', notes: 'Essential for bone development' },
                    { nutrient: 'Vitamin A', requirement: '2200-4400', unit: 'IU/kg', notes: 'Important for reproduction' }
                ]
            },
            'broiler': {
                name: 'Broiler Chicken',
                requirements: [
                    { nutrient: 'Crude Protein', requirement: '18-23', unit: '%', notes: 'Decreases with age' },
                    { nutrient: 'Energy (ME)', requirement: '3000-3200', unit: 'kcal/kg', notes: 'Metabolizable energy' },
                    { nutrient: 'Lysine', requirement: '1.1-1.4', unit: '%', notes: 'First limiting amino acid' },
                    { nutrient: 'Calcium', requirement: '0.9-1.0', unit: '%', notes: 'For bone development' },
                    { nutrient: 'Phosphorus', requirement: '0.4-0.5', unit: '%', notes: 'Available phosphorus' },
                    { nutrient: 'Methionine', requirement: '0.5-0.6', unit: '%', notes: 'Essential amino acid' }
                ]
            },
            'layer': {
                name: 'Layer Hen',
                requirements: [
                    { nutrient: 'Crude Protein', requirement: '16-18', unit: '%', notes: 'During laying period' },
                    { nutrient: 'Energy (ME)', requirement: '2750-2850', unit: 'kcal/kg', notes: 'Metabolizable energy' },
                    { nutrient: 'Calcium', requirement: '3.5-4.0', unit: '%', notes: 'For eggshell formation' },
                    { nutrient: 'Phosphorus', requirement: '0.35-0.4', unit: '%', notes: 'Available phosphorus' },
                    { nutrient: 'Lysine', requirement: '0.85-0.9', unit: '%', notes: 'For egg protein' },
                    { nutrient: 'Linoleic Acid', requirement: '1.0-1.2', unit: '%', notes: 'Essential fatty acid' }
                ]
            },
            'pig': {
                name: 'Pig',
                requirements: [
                    { nutrient: 'Crude Protein', requirement: '14-20', unit: '%', notes: 'Varies by weight/stage' },
                    { nutrient: 'Energy (DE)', requirement: '3300-3400', unit: 'kcal/kg', notes: 'Digestible energy' },
                    { nutrient: 'Lysine', requirement: '0.9-1.4', unit: '%', notes: 'First limiting amino acid' },
                    { nutrient: 'Calcium', requirement: '0.6-0.8', unit: '%', notes: 'For bone development' },
                    { nutrient: 'Phosphorus', requirement: '0.5-0.6', unit: '%', notes: 'Available phosphorus' },
                    { nutrient: 'Threonine', requirement: '0.6-0.9', unit: '%', notes: 'Second limiting amino acid' }
                ]
            }
        };

        // AI responses database
        const aiResponses = {
            greeting: [
                "Hello! I'm here to help with your animal nutrition questions. What would you like to know?",
                "Hi there! I can assist you with feeding recommendations, nutritional calculations, and more. How can I help?",
                "Welcome! I'm your AI nutrition assistant. Feel free to ask me about animal feeding, nutrition requirements, or health concerns."
            ],
            protein: [
                "Protein requirements vary by animal type and production stage. For example, dairy cows need 16-18% crude protein, while broilers need 18-23% depending on their age.",
                "Protein is essential for growth, milk production, and tissue repair. The quality of protein (amino acid profile) is just as important as the quantity.",
                "High-quality protein sources include soybean meal, fish meal, and meat meal. Plant proteins often need amino acid supplementation."
            ],
            energy: [
                "Energy is the most expensive component of animal feeds. Cereal grains like corn and wheat are primary energy sources.",
                "Energy requirements increase with production level. A high-producing dairy cow needs much more energy than a dry cow.",
                "Fats and oils provide 2.25 times more energy than carbohydrates and can improve feed efficiency when used properly."
            ],
            calcium: [
                "Calcium is crucial for bone development, muscle function, and eggshell formation in poultry. The Ca:P ratio should be around 2:1.",
                "Limestone is the most common calcium source in feeds. Dairy cows and laying hens have the highest calcium requirements.",
                "Calcium deficiency can cause milk fever in dairy cows and weak eggshells in poultry."
            ],
            vitamins: [
                "Vitamins are essential micronutrients. Fat-soluble vitamins (A, D, E, K) can be stored in the body, while water-soluble vitamins (B-complex, C) need regular supply.",
                "Vitamin D is crucial for calcium absorption. Vitamin E works with selenium as an antioxidant.",
                "Most commercial feeds include vitamin premixes to ensure adequate levels of all essential vitamins."
            ],
            water: [
                "Water is the most important nutrient! Animals can survive longer without feed than without water.",
                "Water requirements increase with temperature, production level, and dry matter intake. Dairy cows need 3-5 liters per liter of milk produced.",
                "Water quality is crucial - high mineral content or contamination can reduce intake and performance."
            ]
        };

        // Data SDK Handler
        const dataHandler = {
            onDataChanged(data) {
                currentRecordCount = data.length;
                consultationHistory = data;
                displayConsultationHistory();
            }
        };

        // Element SDK Configuration
        const defaultConfig = {
            assistant_title: "AI Nutrition Assistant",
            assistant_subtitle: "Get personalized feeding recommendations",
            company_name: "Bounty Millers Limited",
            welcome_message: "Welcome to our intelligent nutrition advisory system"
        };

        // Initialize SDKs
        async function initializeSDKs() {
            try {
                // Initialize Data SDK
                if (window.dataSdk) {
                    const initResult = await window.dataSdk.init(dataHandler);
                    if (!initResult.isOk) {
                        console.error("Failed to initialize Data SDK");
                    }
                }

                // Initialize Element SDK
                if (window.elementSdk) {
                    window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            // Update assistant title and subtitle
                            const titleElement = document.getElementById('assistant-title');
                            if (titleElement) {
                                titleElement.textContent = config.assistant_title || defaultConfig.assistant_title;
                            }

                            const subtitleElement = document.getElementById('assistant-subtitle');
                            if (subtitleElement) {
                                subtitleElement.textContent = config.assistant_subtitle || defaultConfig.assistant_subtitle;
                            }

                            // Update welcome message
                            const welcomeElement = document.getElementById('welcome-message');
                            if (welcomeElement) {
                                welcomeElement.textContent = config.welcome_message || defaultConfig.welcome_message;
                            }

                            // Update company name
                            const companyElement = document.getElementById('company-name');
                            if (companyElement) {
                                companyElement.textContent = config.company_name || defaultConfig.company_name;
                            }
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [],
                            borderables: [],
                            fontEditable: undefined,
                            fontSizeable: undefined
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ["assistant_title", config.assistant_title || defaultConfig.assistant_title],
                            ["assistant_subtitle", config.assistant_subtitle || defaultConfig.assistant_subtitle],
                            ["company_name", config.company_name || defaultConfig.company_name],
                            ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
                        ])
                    });
                }
            } catch (error) {
                console.error("SDK initialization error:", error);
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeSDKs();
            updateCalculator();
        });

        // Show consultation form
        function showConsultationForm() {
            hideAllSections();
            document.getElementById('consultation-form').classList.remove('hidden');
        }

        // Hide consultation form
        function hideConsultationForm() {
            document.getElementById('consultation-form').classList.add('hidden');
        }

        // Show nutrition calculator
        function showNutritionCalculator() {
            hideAllSections();
            document.getElementById('nutrition-calculator').classList.remove('hidden');
            updateCalculator();
        }

        // Hide nutrition calculator
        function hideNutritionCalculator() {
            document.getElementById('nutrition-calculator').classList.add('hidden');
        }

        // Show feeding guide
        function showFeedingGuide() {
            hideAllSections();
            document.getElementById('feeding-guide').classList.remove('hidden');
        }

        // Hide feeding guide
        function hideFeedingGuide() {
            document.getElementById('feeding-guide').classList.add('hidden');
        }

        // Show chat interface
        function showChatInterface() {
            hideAllSections();
            document.getElementById('chat-interface').classList.remove('hidden');
        }

        // Hide chat interface
        function hideChatInterface() {
            document.getElementById('chat-interface').classList.add('hidden');
        }

        // Hide all sections
        function hideAllSections() {
            document.getElementById('consultation-form').classList.add('hidden');
            document.getElementById('nutrition-calculator').classList.add('hidden');
            document.getElementById('feeding-guide').classList.add('hidden');
            document.getElementById('chat-interface').classList.add('hidden');
        }

        // Submit consultation
        async function submitConsultation(event) {
            event.preventDefault();
            
            if (currentRecordCount >= 999) {
                showToast('Maximum limit of 999 consultations reached. Please delete some consultations first.', 'error');
                return;
            }

            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="spinner"></span> Generating Recommendation...';
            submitBtn.disabled = true;

            // Get form data
            const formData = {
                animalType: document.getElementById('animal-type').value,
                weight: parseFloat(document.getElementById('animal-weight').value),
                productionStage: document.getElementById('production-stage').value,
                currentFeed: document.getElementById('current-feed').value,
                healthIssues: document.getElementById('health-issues').value,
                userName: document.getElementById('user-name').value || 'User'
            };

            // Generate AI recommendation
            const recommendation = generateRecommendation(formData);

            // Create consultation record
            const consultation = {
                id: 'consultation-' + Date.now(),
                animal_type: formData.animalType,
                animal_weight: formData.weight,
                production_stage: formData.productionStage,
                current_feed: formData.currentFeed,
                health_issues: formData.healthIssues,
                recommendation: recommendation.recommendation,
                nutritional_requirements: recommendation.nutritionalRequirements,
                feeding_schedule: recommendation.feedingSchedule,
                created_at: new Date().toISOString(),
                user_name: formData.userName
            };

            // Save consultation
            if (window.dataSdk) {
                const result = await window.dataSdk.create(consultation);
                if (result.isOk) {
                    showToast('Consultation saved successfully!', 'success');
                    displayRecommendation(recommendation, formData);
                } else {
                    showToast('Failed to save consultation. Please try again.', 'error');
                }
            } else {
                showToast('Recommendation generated successfully!', 'success');
                displayRecommendation(recommendation, formData);
            }

            // Reset form and button
            document.getElementById('nutrition-form').reset();
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            hideConsultationForm();
        }

        // Generate AI recommendation
        function generateRecommendation(formData) {
            const { animalType, weight, productionStage, currentFeed, healthIssues } = formData;
            
            // Base recommendations by animal type
            const recommendations = {
                'cattle': {
                    dailyFeed: Math.round(weight * 0.025 * 100) / 100,
                    protein: '16-18%',
                    energy: '1.6-1.8 Mcal/kg NEL',
                    specialNotes: 'Ensure adequate fiber (28-35% NDF) for proper rumen function.'
                },
                'beef-cattle': {
                    dailyFeed: Math.round(weight * 0.02 * 100) / 100,
                    protein: '12-16%',
                    energy: '65-75% TDN',
                    specialNotes: 'Focus on energy density for efficient weight gain.'
                },
                'poultry': {
                    dailyFeed: Math.round(weight * 0.1 * 100) / 100,
                    protein: '16-18%',
                    energy: '2750-2850 kcal/kg ME',
                    specialNotes: 'Provide 3.5-4% calcium for optimal eggshell quality.'
                },
                'broilers': {
                    dailyFeed: Math.round(weight * 0.08 * 100) / 100,
                    protein: '18-23%',
                    energy: '3000-3200 kcal/kg ME',
                    specialNotes: 'High protein and energy for rapid growth.'
                },
                'swine': {
                    dailyFeed: Math.round(weight * 0.03 * 100) / 100,
                    protein: '14-20%',
                    energy: '3300-3400 kcal/kg DE',
                    specialNotes: 'Ensure adequate lysine (0.9-1.4%) for optimal growth.'
                },
                'sheep': {
                    dailyFeed: Math.round(weight * 0.025 * 100) / 100,
                    protein: '12-16%',
                    energy: '60-70% TDN',
                    specialNotes: 'Provide good quality forage as the base of the diet.'
                },
                'goat': {
                    dailyFeed: Math.round(weight * 0.03 * 100) / 100,
                    protein: '14-18%',
                    energy: '65-75% TDN',
                    specialNotes: 'Goats prefer browse and variety in their diet.'
                }
            };

            const baseRec = recommendations[animalType] || recommendations['cattle'];
            
            // Adjust for production stage
            let adjustedProtein = baseRec.protein;
            let adjustedEnergy = baseRec.energy;
            let stageNotes = '';
            
            switch (productionStage) {
                case 'lactating':
                    stageNotes = 'Increased energy and protein requirements during lactation. ';
                    break;
                case 'growing':
                    stageNotes = 'Higher protein requirements for optimal growth. ';
                    break;
                case 'breeding':
                    stageNotes = 'Ensure adequate body condition and nutrition for successful breeding. ';
                    break;
                case 'finishing':
                    stageNotes = 'Focus on energy density for efficient weight gain. ';
                    break;
                case 'dry':
                    stageNotes = 'Controlled energy to prevent excessive weight gain. ';
                    break;
            }

            // Health considerations
            let healthNotes = '';
            if (healthIssues) {
                healthNotes = `Special attention needed for health issues: ${healthIssues}. Consider consulting with a veterinarian for specific dietary modifications. `;
            }

            const recommendation = `
                Based on your ${animalType} (${weight}kg) in ${productionStage} stage:
                
                **Daily Feed Intake:** ${baseRec.dailyFeed}kg dry matter
                **Protein Requirements:** ${adjustedProtein} crude protein
                **Energy Requirements:** ${adjustedEnergy}
                
                ${stageNotes}${baseRec.specialNotes} ${healthNotes}
                
                **Feed Quality:** Ensure feed is fresh, mold-free, and properly stored. Regular feed analysis is recommended to verify nutritional content.
            `;

            const nutritionalRequirements = `
                • Crude Protein: ${adjustedProtein}
                • Energy: ${adjustedEnergy}
                • Calcium: 0.6-0.8% (higher for lactating animals)
                • Phosphorus: 0.4-0.5%
                • Vitamin A: 2000-4000 IU/kg
                • Vitamin D: 300-600 IU/kg
                • Vitamin E: 15-30 IU/kg
            `;

            const feedingSchedule = `
                **Morning (6:00 AM):** 40% of daily ration
                **Midday (12:00 PM):** 20% of daily ration (if applicable)
                **Evening (6:00 PM):** 40% of daily ration
                
                **Water:** Provide fresh, clean water at all times
                **Monitoring:** Check feed intake daily and adjust as needed
                **Frequency:** ${animalType.includes('poultry') ? '2-3 times daily' : '2 times daily'}
            `;

            return {
                recommendation: recommendation.trim(),
                nutritionalRequirements: nutritionalRequirements.trim(),
                feedingSchedule: feedingSchedule.trim()
            };
        }

        // Display recommendation
        function displayRecommendation(recommendation, formData) {
            const recommendationHtml = `
                <div class="recommendation-card">
                    <h4 class="text-xl font-bold text-ai-primary mb-4">
                        <i class="fas fa-magic mr-2"></i>
                        AI Recommendation for ${formData.animalType} (${formData.weight}kg)
                    </h4>
                    
                    <div class="space-y-6">
                        <div>
                            <h5 class="font-bold text-lg mb-2">Feeding Recommendation</h5>
                            <div class="whitespace-pre-line text-gray-700">${recommendation.recommendation}</div>
                        </div>
                        
                        <div>
                            <h5 class="font-bold text-lg mb-2">Nutritional Requirements</h5>
                            <div class="whitespace-pre-line text-gray-700">${recommendation.nutritionalRequirements}</div>
                        </div>
                        
                        <div>
                            <h5 class="font-bold text-lg mb-2">Feeding Schedule</h5>
                            <div class="whitespace-pre-line text-gray-700">${recommendation.feedingSchedule}</div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                        <p class="text-sm text-yellow-800">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            This recommendation is generated by AI and should be used as a guideline. 
                            Always consult with a qualified animal nutritionist or veterinarian for specific cases.
                        </p>
                    </div>
                </div>
            `;
            
            // Insert recommendation after the welcome section
            const welcomeSection = document.querySelector('.ai-card');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = recommendationHtml;
            welcomeSection.parentNode.insertBefore(tempDiv.firstElementChild, welcomeSection.nextSibling);
            
            // Scroll to recommendation
            tempDiv.firstElementChild.scrollIntoView({ behavior: 'smooth' });
        }

        // Update nutrition calculator
        function updateCalculator() {
            const animalType = document.getElementById('calc-animal').value;
            const weight = parseFloat(document.getElementById('calc-weight').value) || 500;
            
            const data = nutritionData[animalType];
            if (!data) return;
            
            const tableBody = document.getElementById('nutrition-table-body');
            tableBody.innerHTML = '';
            
            data.requirements.forEach(req => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="font-semibold">${req.nutrient}</td>
                    <td>${req.requirement}</td>
                    <td>${req.unit}</td>
                    <td class="text-sm text-gray-600">${req.notes}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Chat functionality
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addChatMessage(message, 'user');
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Generate AI response
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateAIResponse(message);
                addChatMessage(response, 'assistant');
            }, 1500);
        }

        function addChatMessage(message, sender) {
            const chatContainer = document.getElementById('chat-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            chatMessages.push({ message, sender, timestamp: new Date() });
        }

        function showTypingIndicator() {
            const chatContainer = document.getElementById('chat-container');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typing-indicator';
            
            typingDiv.innerHTML = `
                <div class="message-avatar"><i class="fas fa-robot"></i></div>
                <div class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Simple keyword matching for responses
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                return getRandomResponse(aiResponses.greeting);
            } else if (lowerMessage.includes('protein')) {
                return getRandomResponse(aiResponses.protein);
            } else if (lowerMessage.includes('energy') || lowerMessage.includes('calorie')) {
                return getRandomResponse(aiResponses.energy);
            } else if (lowerMessage.includes('calcium') || lowerMessage.includes('mineral')) {
                return getRandomResponse(aiResponses.calcium);
            } else if (lowerMessage.includes('vitamin')) {
                return getRandomResponse(aiResponses.vitamins);
            } else if (lowerMessage.includes('water')) {
                return getRandomResponse(aiResponses.water);
            } else if (lowerMessage.includes('dairy') || lowerMessage.includes('cow')) {
                return "Dairy cows have high nutritional demands. They typically need 3-4% of their body weight in dry matter daily, with 16-18% crude protein and high-quality forage. Would you like specific recommendations for your dairy operation?";
            } else if (lowerMessage.includes('poultry') || lowerMessage.includes('chicken')) {
                return "Poultry nutrition varies by type and age. Broilers need 18-23% protein for rapid growth, while layers need 16-18% protein plus 3.5-4% calcium for eggshell formation. What specific poultry questions do you have?";
            } else if (lowerMessage.includes('pig') || lowerMessage.includes('swine')) {
                return "Pig nutrition focuses on efficient growth and feed conversion. They typically need 14-20% protein depending on weight, with lysine being the first limiting amino acid. Are you looking for specific pig feeding recommendations?";
            } else {
                return "That's an interesting question about animal nutrition! While I can provide general guidance on feeding, nutritional requirements, and best practices, I'd recommend consulting with a qualified animal nutritionist for specific situations. Is there a particular aspect of animal nutrition you'd like to explore?";
            }
        }

        function getRandomResponse(responses) {
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function clearChat() {
            const chatContainer = document.getElementById('chat-container');
            chatContainer.innerHTML = `
                <div class="message assistant">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>Hello! I'm your AI nutrition assistant. I can help you with:</p>
                        <ul class="mt-2 space-y-1">
                            <li>• Feeding recommendations</li>
                            <li>• Nutritional calculations</li>
                            <li>• Feed formulation advice</li>
                            <li>• Health and nutrition questions</li>
                        </ul>
                        <p class="mt-2">What would you like to know about animal nutrition?</p>
                    </div>
                </div>
            `;
            chatMessages = [];
        }

        // Display consultation history
        function displayConsultationHistory() {
            const container = document.getElementById('consultation-history');
            
            if (consultationHistory.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard-list text-4xl mb-4 opacity-50"></i>
                        <p>No consultations yet. Start your first nutrition consultation to see recommendations here!</p>
                    </div>
                `;
                return;
            }

            let html = '';
            consultationHistory.slice().reverse().forEach(consultation => {
                const date = new Date(consultation.created_at).toLocaleDateString();
                const time = new Date(consultation.created_at).toLocaleTimeString();
                
                const animalBadgeClass = `badge-${consultation.animal_type.replace('-', '')}`;
                
                html += `
                    <div class="history-item">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h4 class="font-bold text-lg text-ai-text capitalize">${consultation.animal_type.replace('-', ' ')}</h4>
                                <div class="flex items-center gap-2 mt-1">
                                    <span class="badge ${animalBadgeClass}">${consultation.animal_type}</span>
                                    <span class="text-sm text-gray-600">${consultation.animal_weight}kg</span>
                                    <span class="text-sm text-gray-600 capitalize">${consultation.production_stage}</span>
                                </div>
                            </div>
                            <div class="text-right text-sm text-gray-500">
                                <div>${date}</div>
                                <div>${time}</div>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <h5 class="font-semibold text-ai-primary mb-2">Recommendation</h5>
                                <p class="text-sm text-gray-700 whitespace-pre-line">${consultation.recommendation.substring(0, 200)}${consultation.recommendation.length > 200 ? '...' : ''}</p>
                            </div>
                            
                            ${consultation.current_feed ? `
                                <div>
                                    <h5 class="font-semibold text-ai-secondary mb-1">Current Feed</h5>
                                    <p class="text-sm text-gray-600">${consultation.current_feed}</p>
                                </div>
                            ` : ''}
                            
                            ${consultation.health_issues ? `
                                <div>
                                    <h5 class="font-semibold text-ai-accent mb-1">Health Considerations</h5>
                                    <p class="text-sm text-gray-600">${consultation.health_issues}</p>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="flex justify-between items-center mt-4 pt-4 border-t border-gray-200">
                            <span class="text-sm text-gray-500">Consultation by ${consultation.user_name}</span>
                            <button onclick="deleteConsultation('${consultation.id}')" class="text-red-500 hover:text-red-700 transition-colors text-sm">
                                <i class="fas fa-trash mr-1"></i>Delete
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Delete consultation
        async function deleteConsultation(consultationId) {
            const consultation = consultationHistory.find(c => c.id === consultationId);
            if (!consultation) return;

            if (window.dataSdk) {
                const result = await window.dataSdk.delete(consultation);
                if (result.isOk) {
                    showToast('Consultation deleted successfully!', 'success');
                } else {
                    showToast('Failed to delete consultation. Please try again.', 'error');
                }
            } else {
                showToast('Consultation deleted!', 'success');
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'exclamation-triangle'} mr-2"></i>
                ${message}
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 4000);
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99769f1250158a6a',t:'MTc2MTk1MDA4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
